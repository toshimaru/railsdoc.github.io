<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
  <link href="/assets/css/style.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/monokai.min.css">
  <link rel="apple-touch-icon" href="icon.png">
  <meta name="theme-color" content="#fafafa">
  <link href="https://fonts.googleapis.com/css?family=Asap" rel="stylesheet">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ActionDispatch::Assertions::RoutingAssertions | RailsDoc(Œ≤)</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="ActionDispatch::Assertions::RoutingAssertions" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Ruby on Rails API Documentation." />
<meta property="og:description" content="Ruby on Rails API Documentation." />
<link rel="canonical" href="https://railsdoc.github.io/classes/ActionDispatch/Assertions/RoutingAssertions.html" />
<meta property="og:url" content="https://railsdoc.github.io/classes/ActionDispatch/Assertions/RoutingAssertions.html" />
<meta property="og:site_name" content="RailsDoc(Œ≤)" />
<meta property="og:image" content="https://avatars.githubusercontent.com/u/4223" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://avatars.githubusercontent.com/u/4223" />
<meta property="twitter:title" content="ActionDispatch::Assertions::RoutingAssertions" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Ruby on Rails API Documentation.","headline":"ActionDispatch::Assertions::RoutingAssertions","image":"https://avatars.githubusercontent.com/u/4223","url":"https://railsdoc.github.io/classes/ActionDispatch/Assertions/RoutingAssertions.html"}</script>
<!-- End Jekyll SEO tag -->

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134470810-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-134470810-1');

    window.config = {
      rootPath: "/"
    }
  </script>
</head>
<body>
  <header class="navbar navbar-dark navbar-expand bg-dark flex-md-nowrap p-0 shadow sticky-header">
    <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="/">RailsDoc(Œ≤)</a>
    <form class="w-100 d-none d-md-flex" action="/search" method="get">
      <input id="search-form" class="form-control form-control-dark" type="text" placeholder="Search" aria-label="Search" name="q">
    </form>

    <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex px-1">
      <li class="nav-item text-nowrap p-1">
        <div class="dropdown">
          <a class="dropdown-toggle nav-link" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            v7.1
          </a>
          <div class="dropdown-menu dropdown-menu-md-right" aria-labelledby="dropdownMenuLink">
            
    
    
    
        <a class="dropdown-item" href="/">v7.1</a>
    

    
    
    
        <a class="dropdown-item" href="/7.0/">v7.0</a>
    

    
    
    
        <a class="dropdown-item" href="/6.1/">v6.1</a>
    

    
    
    
        <a class="dropdown-item" href="/6.0/">v6.0</a>
    

    
    
    
        <a class="dropdown-item" href="/5.2/">v5.2</a>
    


          </div>
        </div>
      </li>
      <li class="nav-item text-nowrap p-1">
        <a class="nav-link p-2" href="https://github.com/railsdoc/railsdoc.github.io">GitHub</a>
      </li>
    </ul>
  </header>

  <div class="container-fluid">
    <div class="row">
      <nav class="col-12 col-md-3 col-xl-2 d-none d-md-block bg-light sidebar-sticky">
        <div id="navigation" class="sidebar-content">
        </div>
      </nav>

      <div class="col-12 col-md-3 col-xl-2 toc-content-sticky">
        <div class="toc-content"><ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#namespace">Namespace</a>
<ul>
<li class="toc-entry toc-h3"><a href="#module">Module</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#methods">Methods</a></li>
<li class="toc-entry toc-h2"><a href="#instance-public-methods">Instance Public methods</a>
<ul>
<li class="toc-entry toc-h3"><a href="#method-i-assert_generates">
            
              assert_generates(expected_path, options, defaults = {}, extras = {}, message = nil)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-assert_recognizes">
            
              assert_recognizes(expected_options, path, extras = {}, msg = nil)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-assert_routing">
            
              assert_routing(path, options, defaults = {}, extras = {}, message = nil)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-method_missing">
            
              method_missing(selector, *args, &amp;block)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-with_routing">
            
              with_routing(&amp;block)
            
          </a></li>
</ul>
</li>
</ul></div>
      </div>

      <main role="main" class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-4">
        <div class="main">
    <div class="banner">
        
            <span>Ruby on Rails 7.1.0</span><br />
        
        <div class="type">Module</div>
        <h1>
            ActionDispatch::Assertions::RoutingAssertions
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/actionpack/lib/action_dispatch/testing/assertions/routing_rb.html">actionpack/lib/action_dispatch/testing/assertions/routing.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>Suite of assertions to test routes generated by Rails and the handling of requests made to them.</p>

    </div>
  

  

  
  


  
    <h2 id="namespace">Namespace</h2>

    
      <h3 id="module">Module</h3>
      <ul>
      
        <li><a href="RoutingAssertions/ClassMethods.html">ActionDispatch::Assertions::RoutingAssertions::ClassMethods</a></li>
      
      </ul>
    

    
  

  
    <h2 id="methods">Methods</h2>
    <ul>
      
        <li>
          <a href="#method-i-assert_generates">assert_generates</a>
        </li>
      
        <li>
          <a href="#method-i-assert_recognizes">assert_recognizes</a>
        </li>
      
        <li>
          <a href="#method-i-assert_routing">assert_routing</a>
        </li>
      
        <li>
          <a href="#method-i-method_missing">method_missing</a>
        </li>
      
        <li>
          <a href="#method-i-with_routing">with_routing</a>
        </li>
      
    </ul>
  

  

  
    

    

    

    

    <!-- Methods -->
    
    
      <h2 id="instance-public-methods">Instance Public methods</h2>
      
        <div class="method">
          <h3 id="method-i-assert_generates">
            
              assert_generates(expected_path, options, defaults = {}, extras = {}, message = nil)
            
          </h3>

          
            <div class="description">
              <p>Asserts that the provided options can be used to generate the provided path. This is the inverse of <code>assert_recognizes</code>. The <code>extras</code> parameter is used to tell the request the names and values of additional request parameters that would be in a query string. The <code>message</code> parameter allows you to specify a custom error message for assertion failures.</p>

<p>The <code>defaults</code> parameter is unused.</p>

<pre><code># Asserts that the default action is generated for a route with no action
assert_generates &quot;/items&quot;, controller: &quot;items&quot;, action: &quot;index&quot;

# Tests that the list action is properly routed
assert_generates &quot;/items/list&quot;, controller: &quot;items&quot;, action: &quot;list&quot;

# Tests the generation of a route with a parameter
assert_generates &quot;/items/list/1&quot;, { controller: &quot;items&quot;, action: &quot;list&quot;, id: &quot;1&quot; }

# Asserts that the generated route gives us our custom route
assert_generates &quot;changesets/12&quot;, { controller: &#39;scm&#39;, action: &#39;show_diff&#39;, revision: &quot;12&quot; }
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 115
      def assert_generates(expected_path, options, defaults = {}, extras = {}, message = nil)
        if expected_path.include?(&quot;://&quot;)
          fail_on(URI::InvalidURIError, message) do
            uri = URI.parse(expected_path)
            expected_path = uri.path.to_s.empty? ? &quot;/&quot; : uri.path
          end
        else
          expected_path = &quot;/#{expected_path}&quot; unless expected_path.start_with?(&quot;/&quot;)
        end

        options = options.clone
        generated_path, query_string_keys = @routes.generate_extras(options, defaults)
        found_extras = options.reject { |k, _| ! query_string_keys.include? k }

        msg = message || sprintf(&quot;found extras &lt;%s&gt;, not &lt;%s&gt;&quot;, found_extras, extras)
        assert_equal(extras, found_extras, msg)

        msg = message || sprintf(&quot;The generated path &lt;%s&gt; did not match &lt;%s&gt;&quot;, generated_path,
            expected_path)
        assert_equal(expected_path, generated_path, msg)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d39db5d1891f7509cde2efc425c9d69bbb77e670/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L115" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-assert_recognizes">
            
              assert_recognizes(expected_options, path, extras = {}, msg = nil)
            
          </h3>

          
            <div class="description">
              <p>Asserts that the routing of the given <code>path</code> was handled correctly and that the parsed options (given in the <code>expected_options</code> hash) match <code>path</code>. Basically, it asserts that Rails recognizes the route given by <code>expected_options</code>.</p>

<p>Pass a hash in the second argument (<code>path</code>) to specify the request method. This is useful for routes requiring a specific HTTP method. The hash should contain a <code>:path</code> with the incoming request path and a <code>:method</code> containing the required HTTP verb.</p>

<pre><code># Asserts that POSTing to /items will call the create action on ItemsController
assert_recognizes({controller: &#39;items&#39;, action: &#39;create&#39;}, {path: &#39;items&#39;, method: :post})
</code></pre>

<p>You can also pass in <code>extras</code> with a hash containing URL parameters that would normally be in the query string. This can be used to assert that values in the query string will end up in the params hash correctly. To test query strings you must use the extras argument because appending the query string on the path directly will not work. For example:</p>

<pre><code># Asserts that a path of &#39;/items/list/1?view=print&#39; returns the correct options
assert_recognizes({controller: &#39;items&#39;, action: &#39;list&#39;, id: &#39;1&#39;, view: &#39;print&#39;}, &#39;items/list/1&#39;, { view: &quot;print&quot; })
</code></pre>

<p>The <code>message</code> parameter allows you to pass in an error message that is displayed upon failure.</p>

<pre><code># Check the default route (i.e., the index action)
assert_recognizes({controller: &#39;items&#39;, action: &#39;index&#39;}, &#39;items&#39;)

# Test a specific action
assert_recognizes({controller: &#39;items&#39;, action: &#39;list&#39;}, &#39;items/list&#39;)

# Test an action with a parameter
assert_recognizes({controller: &#39;items&#39;, action: &#39;destroy&#39;, id: &#39;1&#39;}, &#39;items/destroy/1&#39;)

# Test a custom route
assert_recognizes({controller: &#39;items&#39;, action: &#39;show&#39;, id: &#39;1&#39;}, &#39;view/item1&#39;)
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 77
      def assert_recognizes(expected_options, path, extras = {}, msg = nil)
        if path.is_a?(Hash) &amp;&amp; path[:method].to_s == &quot;all&quot;
          [:get, :post, :put, :delete].each do |method|
            assert_recognizes(expected_options, path.merge(method: method), extras, msg)
          end
        else
          request = recognized_request_for(path, extras, msg)

          expected_options = expected_options.clone

          expected_options.stringify_keys!

          msg = message(msg, &quot;&quot;) {
            sprintf(&quot;The recognized options &lt;%s&gt; did not match &lt;%s&gt;, difference:&quot;,
                    request.path_parameters, expected_options)
          }

          assert_equal(expected_options, request.path_parameters, msg)
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d39db5d1891f7509cde2efc425c9d69bbb77e670/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L77" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-assert_routing">
            
              assert_routing(path, options, defaults = {}, extras = {}, message = nil)
            
          </h3>

          
            <div class="description">
              <p>Asserts that path and options match both ways; in other words, it verifies that <code>path</code> generates <code>options</code> and then that <code>options</code> generates <code>path</code>. This essentially combines <code>assert_recognizes</code> and <code>assert_generates</code> into one step.</p>

<p>The <code>extras</code> hash allows you to specify options that would normally be provided as a query string to the action. The <code>message</code> parameter allows you to specify a custom error message to display upon failure.</p>

<pre><code># Asserts a basic route: a controller with the default action (index)
assert_routing &#39;/home&#39;, controller: &#39;home&#39;, action: &#39;index&#39;

# Test a route generated with a specific controller, action, and parameter (id)
assert_routing &#39;/entries/show/23&#39;, controller: &#39;entries&#39;, action: &#39;show&#39;, id: 23

# Asserts a basic route (controller + default action), with an error message if it fails
assert_routing &#39;/store&#39;, { controller: &#39;store&#39;, action: &#39;index&#39; }, {}, {}, &#39;Route for store index not generated properly&#39;

# Tests a route, providing a defaults hash
assert_routing &#39;controller/action/9&#39;, {id: &quot;9&quot;, item: &quot;square&quot;}, {controller: &quot;controller&quot;, action: &quot;action&quot;}, {}, {item: &quot;square&quot;}

# Tests a route with an HTTP method
assert_routing({ method: &#39;put&#39;, path: &#39;/product/321&#39; }, { controller: &quot;product&quot;, action: &quot;update&quot;, id: &quot;321&quot; })
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 158
      def assert_routing(path, options, defaults = {}, extras = {}, message = nil)
        assert_recognizes(options, path, extras, message)

        controller, default_controller = options[:controller], defaults[:controller]
        if controller &amp;&amp; controller.include?(?/) &amp;&amp; default_controller &amp;&amp; default_controller.include?(?/)
          options[:controller] = &quot;/#{controller}&quot;
        end

        generate_options = options.dup.delete_if { |k, _| defaults.key?(k) }
        assert_generates(path.is_a?(Hash) ? path[:path] : path, generate_options, defaults, extras, message)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d39db5d1891f7509cde2efc425c9d69bbb77e670/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L158" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-method_missing">
            
              method_missing(selector, *args, &amp;block)
            
          </h3>

          
            <div class="description">
              <p>ROUTES TODO: These assertions should really work in an integration context</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 191
      def method_missing(selector, *args, &amp;block)
        if defined?(@controller) &amp;&amp; @controller &amp;&amp; defined?(@routes) &amp;&amp; @routes &amp;&amp; @routes.named_routes.route_defined?(selector)
          @controller.public_send(selector, *args, &amp;block)
        else
          super
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d39db5d1891f7509cde2efc425c9d69bbb77e670/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L191" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-with_routing">
            
              with_routing(&amp;block)
            
          </h3>

          
            <div class="description">
              <p>A helper to make it easier to test different route configurations. This method temporarily replaces @routes with a new RouteSet instance.</p>

<p>The new instance is yielded to the passed block. Typically the block will create some routes using <code>set.draw { match ... }</code>:</p>

<pre><code>with_routing do |set|
  set.draw do
    resources :users
  end
  assert_equal &quot;/users&quot;, users_path
end
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/testing/assertions/routing.rb, line 183
      def with_routing(&amp;block)
        old_routes, old_controller = @routes, @controller
        create_routes(&amp;block)
      ensure
        reset_routes(old_routes, old_controller)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d39db5d1891f7509cde2efc425c9d69bbb77e670/actionpack/lib/action_dispatch/testing/assertions/routing.rb#L183" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
  
</div>

    </div>
</div>

        <footer class="site-footer">
          <!-- <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span> -->
        </footer>
      </main>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js" integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="/assets/js/app.js"></script>
  <script src="/assets/js/search.js"></script>
</body>
</html>
