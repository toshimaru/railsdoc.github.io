<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
  <link href="/assets/css/style.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/monokai.min.css">
  <link rel="apple-touch-icon" href="icon.png">
  <meta name="theme-color" content="#fafafa">
  <link href="https://fonts.googleapis.com/css?family=Asap" rel="stylesheet">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ActiveStorage::Blob | RailsDoc(β)</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="ActiveStorage::Blob" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Ruby on Rails API Documentation." />
<meta property="og:description" content="Ruby on Rails API Documentation." />
<link rel="canonical" href="https://railsdoc.github.io/classes/ActiveStorage/Blob.html" />
<meta property="og:url" content="https://railsdoc.github.io/classes/ActiveStorage/Blob.html" />
<meta property="og:site_name" content="RailsDoc(β)" />
<meta property="og:image" content="https://avatars.githubusercontent.com/u/4223" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://avatars.githubusercontent.com/u/4223" />
<meta property="twitter:title" content="ActiveStorage::Blob" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Ruby on Rails API Documentation.","headline":"ActiveStorage::Blob","image":"https://avatars.githubusercontent.com/u/4223","url":"https://railsdoc.github.io/classes/ActiveStorage/Blob.html"}</script>
<!-- End Jekyll SEO tag -->

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134470810-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-134470810-1');

    window.config = {
      rootPath: "/"
    }
  </script>
</head>
<body>
  <header class="navbar navbar-dark navbar-expand bg-dark flex-md-nowrap p-0 shadow sticky-header">
    <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="/">RailsDoc(β)</a>
    <form class="w-100 d-none d-md-flex" action="/search" method="get">
      <input id="search-form" class="form-control form-control-dark" type="text" placeholder="Search" aria-label="Search" name="q">
    </form>

    <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex px-1">
      <li class="nav-item text-nowrap p-1">
        <div class="dropdown">
          <a class="dropdown-toggle nav-link" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            v7.1
          </a>
          <div class="dropdown-menu dropdown-menu-md-right" aria-labelledby="dropdownMenuLink">
            
    
    
    
        <a class="dropdown-item" href="/">v7.1</a>
    

    
    
    
        <a class="dropdown-item" href="/7.0/">v7.0</a>
    

    
    
    
        <a class="dropdown-item" href="/6.1/">v6.1</a>
    

    
    
    
        <a class="dropdown-item" href="/6.0/">v6.0</a>
    

    
    
    
        <a class="dropdown-item" href="/5.2/">v5.2</a>
    


          </div>
        </div>
      </li>
      <li class="nav-item text-nowrap p-1">
        <a class="nav-link p-2" href="https://github.com/railsdoc/railsdoc.github.io">GitHub</a>
      </li>
    </ul>
  </header>

  <div class="container-fluid">
    <div class="row">
      <nav class="col-12 col-md-3 col-xl-2 d-none d-md-block bg-light sidebar-sticky">
        <div id="navigation" class="sidebar-content">
        </div>
      </nav>

      <div class="col-12 col-md-3 col-xl-2 toc-content-sticky">
        <div class="toc-content"><ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#namespace">Namespace</a>
<ul>
<li class="toc-entry toc-h3"><a href="#module">Module</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#methods">Methods</a></li>
<li class="toc-entry toc-h2"><a href="#included-modules">Included Modules</a></li>
<li class="toc-entry toc-h2"><a href="#constants">Constants</a></li>
<li class="toc-entry toc-h2"><a href="#class-public-methods">Class Public methods</a>
<ul>
<li class="toc-entry toc-h3"><a href="#method-c-compose">
            
              compose(blobs, filename:, content_type: nil, metadata: nil)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-c-create_and_upload-21">
            
              create_and_upload!(key: nil, io:, filename:, content_type: nil, metadata: nil, service_name: nil, identify: true, record: nil)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-c-create_before_direct_upload-21">
            
              create_before_direct_upload!(key: nil, filename:, byte_size:, checksum:, content_type: nil, metadata: nil, service_name: nil, record: nil)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-c-find_signed">
            
              find_signed(id, record: nil, purpose: :blob_id)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-c-find_signed-21">
            
              find_signed!(id, record: nil, purpose: :blob_id)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-c-generate_unique_secure_token">
            
              generate_unique_secure_token(length: MINIMUM_TOKEN_LENGTH)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-c-unattached">
            
              unattached
            
          </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#instance-public-methods">Instance Public methods</a>
<ul>
<li class="toc-entry toc-h3"><a href="#method-i-attachments">
            
              attachments
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-audio-3F">
            
              audio?()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-custom_metadata">
            
              custom_metadata()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-custom_metadata-3D">
            
              custom_metadata=(metadata)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-delete">
            
              delete()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-download">
            
              download(&amp;block)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-download_chunk">
            
              download_chunk(range)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-filename">
            
              filename()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-image-3F">
            
              image?()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-key">
            
              key()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-open">
            
              open(tmpdir: nil, &amp;block)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-purge">
            
              purge()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-purge_later">
            
              purge_later()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-service">
            
              service()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-service_headers_for_direct_upload">
            
              service_headers_for_direct_upload()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-service_url_for_direct_upload">
            
              service_url_for_direct_upload(expires_in: ActiveStorage.service_urls_expire_in)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-signed_id">
            
              signed_id(purpose: :blob_id, expires_in: nil, expires_at: nil)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-text-3F">
            
              text?()
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-upload">
            
              upload(io, identify: true)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-url">
            
              url(expires_in: ActiveStorage.service_urls_expire_in, disposition: :inline, filename: nil, **options)
            
          </a></li>
<li class="toc-entry toc-h3"><a href="#method-i-video-3F">
            
              video?()
            
          </a></li>
</ul>
</li>
</ul></div>
      </div>

      <main role="main" class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-4">
        <div class="main">
    <div class="banner">
        
            <span>Ruby on Rails 7.1.3</span><br />
        
        <div class="type">Class</div>
        <h1>
            ActiveStorage::Blob
            
                <span class="parent">&lt;
                    
                    ActiveStorage::Record
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/activestorage/app/models/active_storage/blob_rb.html">activestorage/app/models/active_storage/blob.rb</a></li>
            
            <li><a href="../../files/activestorage/app/models/active_storage/blob/analyzable_rb.html">activestorage/app/models/active_storage/blob/analyzable.rb</a></li>
            
            <li><a href="../../files/activestorage/app/models/active_storage/blob/identifiable_rb.html">activestorage/app/models/active_storage/blob/identifiable.rb</a></li>
            
            <li><a href="../../files/activestorage/app/models/active_storage/blob/representable_rb.html">activestorage/app/models/active_storage/blob/representable.rb</a></li>
            
            <li><a href="../../files/activestorage/app/models/active_storage/blob/servable_rb.html">activestorage/app/models/active_storage/blob/servable.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="class-ActiveStorage::Blob-label-Active+Storage+Blob">Active Storage Blob</h1>

<p>A blob is a record that contains the metadata about a file and a key for where that file resides on the service. Blobs can be created in two ways:</p>
<ol><li>
<p>Ahead of the file being uploaded server-side to the service, via <code>create_and_upload!</code>. A rewindable <code>io</code> with the file contents must be available at the server for this operation.</p>
</li><li>
<p>Ahead of the file being directly uploaded client-side to the service, via <code>create_before_direct_upload!</code>.</p>
</li></ol>

<p>The first option doesn’t require any client-side JavaScript integration, and can be used by any other back-end service that deals with files. The second option is faster, since you’re not using your own server as a staging point for uploads, and can work with deployments like Heroku that do not provide large amounts of disk space.</p>

<p>Blobs are intended to be immutable in as-so-far as their reference to a specific file goes. You’re allowed to update a blob’s metadata on a subsequent pass, but you should not update the key or change the uploaded file. If you need to create a derivative or otherwise change the blob, simply create a new blob and purge the old one.</p>

    </div>
  

  

  
  


  
    <h2 id="namespace">Namespace</h2>

    
      <h3 id="module">Module</h3>
      <ul>
      
        <li><a href="Blob/Analyzable.html">ActiveStorage::Blob::Analyzable</a></li>
      
        <li><a href="Blob/Identifiable.html">ActiveStorage::Blob::Identifiable</a></li>
      
        <li><a href="Blob/Representable.html">ActiveStorage::Blob::Representable</a></li>
      
      </ul>
    

    
  

  
    <h2 id="methods">Methods</h2>
    <ul>
      
        <li>
          <a href="#method-i-attachments">attachments</a>
        </li>
      
        <li>
          <a href="#method-i-audio-3F">audio?</a>
        </li>
      
        <li>
          <a href="#method-c-compose">compose</a>
        </li>
      
        <li>
          <a href="#method-c-create_and_upload-21">create_and_upload!</a>
        </li>
      
        <li>
          <a href="#method-c-create_before_direct_upload-21">create_before_direct_upload!</a>
        </li>
      
        <li>
          <a href="#method-i-custom_metadata">custom_metadata</a>
        </li>
      
        <li>
          <a href="#method-i-custom_metadata-3D">custom_metadata=</a>
        </li>
      
        <li>
          <a href="#method-i-delete">delete</a>
        </li>
      
        <li>
          <a href="#method-i-download">download</a>
        </li>
      
        <li>
          <a href="#method-i-download_chunk">download_chunk</a>
        </li>
      
        <li>
          <a href="#method-i-filename">filename</a>
        </li>
      
        <li>
          <a href="#method-c-find_signed">find_signed</a>
        </li>
      
        <li>
          <a href="#method-c-find_signed-21">find_signed!</a>
        </li>
      
        <li>
          <a href="#method-c-generate_unique_secure_token">generate_unique_secure_token</a>
        </li>
      
        <li>
          <a href="#method-i-image-3F">image?</a>
        </li>
      
        <li>
          <a href="#method-i-key">key</a>
        </li>
      
        <li>
          <a href="#method-i-open">open</a>
        </li>
      
        <li>
          <a href="#method-i-purge">purge</a>
        </li>
      
        <li>
          <a href="#method-i-purge_later">purge_later</a>
        </li>
      
        <li>
          <a href="#method-i-service">service</a>
        </li>
      
        <li>
          <a href="#method-i-service_headers_for_direct_upload">service_headers_for_direct_upload</a>
        </li>
      
        <li>
          <a href="#method-i-service_url_for_direct_upload">service_url_for_direct_upload</a>
        </li>
      
        <li>
          <a href="#method-i-signed_id">signed_id</a>
        </li>
      
        <li>
          <a href="#method-i-text-3F">text?</a>
        </li>
      
        <li>
          <a href="#method-c-unattached">unattached</a>
        </li>
      
        <li>
          <a href="#method-i-upload">upload</a>
        </li>
      
        <li>
          <a href="#method-i-url">url</a>
        </li>
      
        <li>
          <a href="#method-i-video-3F">video?</a>
        </li>
      
    </ul>
  

  
    <!-- Includes -->
    <h2 id="included-modules">Included Modules</h2>
    <ul>
      
        <li>
          
            <a href="Blob/Analyzable.html">
              ActiveStorage::Blob::Analyzable
            </a>
          
        </li>
      
        <li>
          
            <a href="Blob/Identifiable.html">
              ActiveStorage::Blob::Identifiable
            </a>
          
        </li>
      
        <li>
          
            <a href="Blob/Representable.html">
              ActiveStorage::Blob::Representable
            </a>
          
        </li>
      
    </ul>
  

  
    

    

    
      <!-- Section constants -->
      <h2 id="constants">Constants</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">MINIMUM_TOKEN_LENGTH</td>
            <td>=</td>
            <td class="attr-value">28</td>
          </tr>
          
        
      </table>
    

    

    <!-- Methods -->
    
      <h2 id="class-public-methods">Class Public methods</h2>
      
        <div class="method">
          <h3 id="method-c-compose">
            
              compose(blobs, filename:, content_type: nil, metadata: nil)
            
          </h3>

          
            <div class="description">
              <p>Concatenate multiple blobs into a single “composed” blob.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 150
    def compose(blobs, filename:, content_type: nil, metadata: nil)
      raise ActiveRecord::RecordNotSaved, &quot;All blobs must be persisted.&quot; if blobs.any?(&amp;:new_record?)

      content_type ||= blobs.pluck(:content_type).compact.first

      new(filename: filename, content_type: content_type, metadata: metadata, byte_size: blobs.sum(&amp;:byte_size)).tap do |combined_blob|
        combined_blob.compose(blobs.pluck(:key))
        combined_blob.save!
      end
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L150" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-c-create_and_upload-21">
            
              create_and_upload!(key: nil, io:, filename:, content_type: nil, metadata: nil, service_name: nil, identify: true, record: nil)
            
          </h3>

          
            <div class="description">
              <p>Creates a new blob instance and then uploads the contents of the given <code>io</code> to the service. The blob instance is going to be saved before the upload begins to prevent the upload clobbering another due to key collisions. When providing a content type, pass <code>identify: false</code> to bypass automatic content type inference.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 101
    def create_and_upload!(key: nil, io:, filename:, content_type: nil, metadata: nil, service_name: nil, identify: true, record: nil)
      create_after_unfurling!(key: key, io: io, filename: filename, content_type: content_type, metadata: metadata, service_name: service_name, identify: identify).tap do |blob|
        blob.upload_without_unfurling(io)
      end
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L101" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-c-create_before_direct_upload-21">
            
              create_before_direct_upload!(key: nil, filename:, byte_size:, checksum:, content_type: nil, metadata: nil, service_name: nil, record: nil)
            
          </h3>

          
            <div class="description">
              <p>Returns a saved blob <em>without</em> uploading a file to the service. This blob will point to a key where there is no file yet. It’s intended to be used together with a client-side upload, which will first create the blob in order to produce the signed URL for uploading. This signed URL points to the key generated by the blob. Once the form using the direct upload is submitted, the blob can be associated with the right record using the signed ID.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 112
    def create_before_direct_upload!(key: nil, filename:, byte_size:, checksum:, content_type: nil, metadata: nil, service_name: nil, record: nil)
      create! key: key, filename: filename, byte_size: byte_size, checksum: checksum, content_type: content_type, metadata: metadata, service_name: service_name
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L112" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-c-find_signed">
            
              find_signed(id, record: nil, purpose: :blob_id)
            
          </h3>

          
            <div class="description">
              <p>You can use the signed ID of a blob to refer to it on the client side without fear of tampering. This is particularly helpful for direct uploads where the client-side needs to refer to the blob that was created ahead of the upload itself on form submission.</p>

<p>The signed ID is also used to create stable URLs for the blob through the BlobsController.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 74
    def find_signed(id, record: nil, purpose: :blob_id)
      super(id, purpose: purpose)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L74" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-c-find_signed-21">
            
              find_signed!(id, record: nil, purpose: :blob_id)
            
          </h3>

          
            <div class="description">
              <p>Works like <code>find_signed</code>, but will raise an <code>ActiveSupport::MessageVerifier::InvalidSignature</code> exception if the <code>signed_id</code> has either expired, has a purpose mismatch, is for another record, or has been tampered with. It will also raise an <code>ActiveRecord::RecordNotFound</code> exception if the valid signed id can’t find a record.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 82
    def find_signed!(id, record: nil, purpose: :blob_id)
      super(id, purpose: purpose)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L82" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-c-generate_unique_secure_token">
            
              generate_unique_secure_token(length: MINIMUM_TOKEN_LENGTH)
            
          </h3>

          
            <div class="description">
              <p>To prevent problems with case-insensitive filesystems, especially in combination with databases which treat indices as case-sensitive, all blob keys generated are going to only contain the base-36 character alphabet and will therefore be lowercase. To maintain the same or higher amount of entropy as in the base-58 encoding used by <code>has_secure_token</code> the number of bytes used is increased to 28 from the standard 24</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 121
    def generate_unique_secure_token(length: MINIMUM_TOKEN_LENGTH)
      SecureRandom.base36(length)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L121" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-c-unattached">
            
              unattached
            
          </h3>

          
            <div class="description">
              <p>Returns the blobs that aren’t attached to any record.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 43
  scope :unattached, -&gt; { where.missing(:attachments) }
</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L43" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
      <h2 id="instance-public-methods">Instance Public methods</h2>
      
        <div class="method">
          <h3 id="method-i-attachments">
            
              attachments
            
          </h3>

          
            <div class="description">
              <p>Returns the associated <a href="Attachment.html"><code>ActiveStorage::Attachment</code></a> instances.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 37
  has_many :attachments
</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L37" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-audio-3F">
            
              audio?()
            
          </h3>

          
            <div class="description">
              <p>Returns true if the content_type of this blob is in the audio range, like audio/mpeg.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 197
  def audio?
    content_type.start_with?(&quot;audio&quot;)
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L197" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-custom_metadata">
            
              custom_metadata()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 183
  def custom_metadata
    self[:metadata][:custom] || {}
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L183" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-custom_metadata-3D">
            
              custom_metadata=(metadata)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 187
  def custom_metadata=(metadata)
    self[:metadata] = self[:metadata].merge(custom: metadata)
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L187" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-delete">
            
              delete()
            
          </h3>

          
            <div class="description">
              <p>Deletes the files on the service associated with the blob. This should only be done if the blob is going to be deleted as well or you will essentially have a dead reference. It’s recommended to use <a href="Blob.html#method-i-purge"><code>purge</code></a> and <a href="Blob.html#method-i-purge_later"><code>purge_later</code></a> methods in most circumstances.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 307
  def delete
    service.delete(key)
    service.delete_prefixed(&quot;variants/#{key}/&quot;) if image?
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L307" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-download">
            
              download(&amp;block)
            
          </h3>

          
            <div class="description">
              <p>Downloads the file associated with this blob. If no block is given, the entire file is read into memory and returned. That’ll use a lot of RAM for very large files. If a block is given, then the download is streamed and yielded in chunks.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 267
  def download(&amp;block)
    service.download key, &amp;block
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L267" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-download_chunk">
            
              download_chunk(range)
            
          </h3>

          
            <div class="description">
              <p>Downloads a part of the file associated with this blob.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 272
  def download_chunk(range)
    service.download_chunk key, range
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L272" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-filename">
            
              filename()
            
          </h3>

          
            <div class="description">
              <p>Returns an <a href="Filename.html"><code>ActiveStorage::Filename</code></a> instance of the filename that can be queried for basename, extension, and a sanitized version of the filename that’s safe to use in URLs.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 179
  def filename
    ActiveStorage::Filename.new(self[:filename])
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L179" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-image-3F">
            
              image?()
            
          </h3>

          
            <div class="description">
              <p>Returns true if the content_type of this blob is in the image range, like image/png.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 192
  def image?
    content_type.start_with?(&quot;image&quot;)
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L192" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-key">
            
              key()
            
          </h3>

          
            <div class="description">
              <p>Returns the key pointing to the file on the service that’s associated with this blob. The key is the secure-token format from Rails in lower case. So it’ll look like: xtapjjcjiudrlk3tmwyjgpuobabd. This key is not intended to be revealed directly to the user. Always refer to blobs using the <a href="Blob.html#method-i-signed_id"><code>signed_id</code></a> or a verified form of the key.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 171
  def key
    # We can&#39;t wait until the record is first saved to have a key for it
    self[:key] ||= self.class.generate_unique_secure_token(length: MINIMUM_TOKEN_LENGTH)
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L171" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-open">
            
              open(tmpdir: nil, &amp;block)
            
          </h3>

          
            <div class="description">
              <p>Downloads the blob to a tempfile on disk. Yields the tempfile.</p>

<p>The tempfile’s name is prefixed with <code>ActiveStorage-</code> and the blob’s ID. Its extension matches that of the blob.</p>

<p>By default, the tempfile is created in <code>Dir.tmpdir</code>. Pass <code>tmpdir:</code> to create it in a different directory:</p>

<pre><code>blob.open(tmpdir: &quot;/path/to/tmp&quot;) do |file|
  # ...
end
</code></pre>

<p>The tempfile is automatically closed and unlinked after the given block is executed.</p>

<p>Raises <a href="IntegrityError.html"><code>ActiveStorage::IntegrityError</code></a> if the downloaded data does not match the blob’s checksum.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 289
  def open(tmpdir: nil, &amp;block)
    service.open(
      key,
      checksum: checksum,
      verify: !composed,
      name: [ &quot;ActiveStorage-#{id}-&quot;, filename.extension_with_delimiter ],
      tmpdir: tmpdir,
      &amp;block
    )
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L289" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-purge">
            
              purge()
            
          </h3>

          
            <div class="description">
              <p>Destroys the blob record and then deletes the file on the service. This is the recommended way to dispose of unwanted blobs. Note, though, that deleting the file off the service will initiate an HTTP connection to the service, which may be slow or prevented, so you should not use this method inside a transaction or in callbacks. Use <a href="Blob.html#method-i-purge_later"><code>purge_later</code></a> instead.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 315
  def purge
    destroy
    delete if previously_persisted?
  rescue ActiveRecord::InvalidForeignKey
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L315" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-purge_later">
            
              purge_later()
            
          </h3>

          
            <div class="description">
              <p>Enqueues an <a href="PurgeJob.html"><code>ActiveStorage::PurgeJob</code></a> to call <a href="Blob.html#method-i-purge"><code>purge</code></a>. This is the recommended way to purge blobs from a transaction, an Active Record callback, or in any other real-time scenario.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 323
  def purge_later
    ActiveStorage::PurgeJob.perform_later(self)
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L323" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-service">
            
              service()
            
          </h3>

          
            <div class="description">
              <p>Returns an instance of service, which can be configured globally or per attachment</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 328
  def service
    services.fetch(service_name)
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L328" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-service_headers_for_direct_upload">
            
              service_headers_for_direct_upload()
            
          </h3>

          
            <div class="description">
              <p>Returns a <a href="../Hash.html"><code>Hash</code></a> of headers for <code>service_url_for_direct_upload</code> requests.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 227
  def service_headers_for_direct_upload
    service.headers_for_direct_upload key, filename: filename, content_type: content_type, content_length: byte_size, checksum: checksum, custom_metadata: custom_metadata
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L227" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-service_url_for_direct_upload">
            
              service_url_for_direct_upload(expires_in: ActiveStorage.service_urls_expire_in)
            
          </h3>

          
            <div class="description">
              <p>Returns a URL that can be used to directly upload a file for this blob on the service. This URL is intended to be short-lived for security and only generated on-demand by the client-side JavaScript responsible for doing the uploading.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 222
  def service_url_for_direct_upload(expires_in: ActiveStorage.service_urls_expire_in)
    service.url_for_direct_upload key, expires_in: expires_in, content_type: content_type, content_length: byte_size, checksum: checksum, custom_metadata: custom_metadata
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L222" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-signed_id">
            
              signed_id(purpose: :blob_id, expires_in: nil, expires_at: nil)
            
          </h3>

          
            <div class="description">
              <p>Returns a signed ID for this blob that’s suitable for reference on the client-side without fear of tampering.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 163
  def signed_id(purpose: :blob_id, expires_in: nil, expires_at: nil)
    super
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L163" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-text-3F">
            
              text?()
            
          </h3>

          
            <div class="description">
              <p>Returns true if the content_type of this blob is in the text range, like text/plain.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 207
  def text?
    content_type.start_with?(&quot;text&quot;)
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L207" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-upload">
            
              upload(io, identify: true)
            
          </h3>

          
            <div class="description">
              <p>Uploads the <code>io</code> to the service on the <code>key</code> for this blob. Blobs are intended to be immutable, so you shouldn’t be using this method after a file has already been uploaded to fit with a blob. If you want to create a derivative blob, you should instead simply create a new blob based on the old one.</p>

<p>Prior to uploading, we compute the checksum, which is sent to the service for transit integrity validation. If the checksum does not match what the service receives, an exception will be raised. We also measure the size of the <code>io</code> and store that in <code>byte_size</code> on the blob record. The content type is automatically extracted from the <code>io</code> unless you specify a <code>content_type</code> and pass <code>identify</code> as false.</p>

<p>Normally, you do not have to call this method directly at all. Use the <code>create_and_upload!</code> class method instead. If you do use this method directly, make sure you are using it on a persisted <a href="Blob.html"><code>Blob</code></a> as otherwise another blob’s data might get overwritten on the service.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 244
  def upload(io, identify: true)
    unfurl io, identify: identify
    upload_without_unfurling io
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L244" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-url">
            
              url(expires_in: ActiveStorage.service_urls_expire_in, disposition: :inline, filename: nil, **options)
            
          </h3>

          
            <div class="description">
              <p>Returns the URL of the blob on the service. This returns a permanent URL for public files, and returns a short-lived URL for private files. Private files are signed, and not for public use. Instead, the URL should only be exposed as a redirect from a stable, possibly authenticated URL. Hiding the URL behind a redirect also allows you to change services without updating all URLs.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 215
  def url(expires_in: ActiveStorage.service_urls_expire_in, disposition: :inline, filename: nil, **options)
    service.url key, expires_in: expires_in, filename: ActiveStorage::Filename.wrap(filename || self.filename),
      content_type: content_type_for_serving, disposition: forced_disposition_for_serving || disposition, **options
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L215" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-video-3F">
            
              video?()
            
          </h3>

          
            <div class="description">
              <p>Returns true if the content_type of this blob is in the video range, like video/mp4.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">📝 Source code</span>
              </summary>

              <pre><code class="ruby"># File activestorage/app/models/active_storage/blob.rb, line 202
  def video?
    content_type.start_with?(&quot;video&quot;)
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activestorage/app/models/active_storage/blob.rb#L202" target="_blank" class="github_url">🔎 See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
  
</div>

    </div>
</div>

        <footer class="site-footer">
          <!-- <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span> -->
        </footer>
      </main>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.1/anchor.min.js" integrity="sha512-zPB79j2C+3sFS9zcA3vg/z6bVKzJVEyu9pY5w89akQRys76zpAT2t6S3wZKla3QQ14O5l/Yt0RUQ/DHXx82Y5g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="/assets/js/app.js"></script>
  <script src="/assets/js/search.js"></script>
</body>
</html>
